www.zenner.com
SN: 2198188
(APA GEN: 5
(31.08.2022 09:54)
WATER)
Raw packet (79 bytes):
00 01 02 03 04 05 06 07 08 09 10 11 12 13 14  
4E 44 01 06 88 81 19 02 05 07 7A 57 00 40 85 E5 8C E1 47 A6 62 91 8D 47 AC 49 EA AC D3 1B 60 A9 05 06 F9 11 E0 CA C4 89 FB 58 58 4E 64 F1 FD 7B 84 62 47 71 8E 2E 44 C9 38 E5 EF 7C E4 21 5D 8C C3 B2 2D 78 B4 BD 74 D4 B9 77 11 E9 19 1C BC
      01 06 88 81 19 02 05 07 57 57 57 57 57 57 57 57
      MM MM AA AA AA AA AA AA CC SS SS SS SS FN FN BC
Header:
4Eh (L-Field)
44h (C-Field: Message type SND_NR (Send spontaneous/periodical application data without request (Send /No Reply))
0106 h (Manufacturer-ID: APA DIN Address is presented with 3 ASCII-letters (A-Z, upper case only). See www.dlms.com/flag)
88811902 -> 2198188 (Identification Number of the WATER device (as 8 BCD numbers))
05 h (Generation: 5, forms together with Manufacturer-ID, IdentNumber and Type a unique wM-Bus address)
07 h (Medium: WATER)
7Ah (CI-Field: Short 4 bytes APL header in RSP_UD response from device. Declares the applied type of Transport Layer header)
57h (ACC: 87 Access number incremented every synchronous packet which is not repeated)
00h (STS: 0 M-Bus state contents errors and alerts)
4085h (ConfWord: EncryptionMode: 5, CounOfBlocks: 64, Synchronous: False)
Synchronous: False)
IV (Initialization Vector): 0106 88811902 05 07 57 57 57 57 57 57 57 57
							0106 88811902 05 07 7A 57 00 40 85 E5 8C 
							ID    
							
AES 128 Key: 00000000000000000000000000000000
Data (64 bytes):
2F 2F 0F 59 BB D8 96 98 02 08 43 C7 04 87 80 B7 96 AC AF D6 08 CE 0F 00 10 84 C2 07 00 72 01 E1 93 07 00 5B 77 07 00 C7 E0 06 00 A0
96 5B C8 03 FF FF FF FF FF FF FF FF FF FF FF FF FF FF C8 0C
Meter values:
DIF:0Fh (SpecialFunctions) Data:59BBD89698020843C7048780B796ACAFD608CE0F001084C207007201E19307005B770700C7E00600A0965BC803FFFFFFFFFFFFFFFFFFFFFFFFFFF
Manufacture specific data 59BBD89698020843C7048780B796ACAFD608CE0F001084C207007201E19307005B770700C7E00600A0965BC803FFFFFFFFFFFFFFFFFFFFFFFFFFFFC8


#### test 1

bufor nie od tej pozycji

frame =

00 01 02 03 04 05 06 07 08 09 10 11 12 13 14  
4E 44 01 06 88 81 19 02 05 07 7A 57 00 40 85 E5 8C E1 47 A6 62 91 8D 47 AC 49 EA AC D3 1B 60 A9 05 06 F9 11 E0 CA C4 89 FB 58 58 4E 64 F1 FD 7B 84 62 47 71 8E 2E 44 C9 38 E5 EF 7C E4 21 5D 8C C3 B2 2D 78 B4 BD 74 D4 B9 77 11 E9 19 1C BC
      01 06 88 81 19 02 05 07 57 57 57 57 57 57 57 57
      MM MM AA AA AA AA AA AA CC SS SS SS SS FN FN BC

4E 44 01 06 88 81 19 02 05 07 7A 5B 00 40 85 2C D9668C844532358CFD58A8BCCE25CE81FD5A82AD9B908EB1503CD2BE6B70B4029B4E262B4E8EB258129274AEE6132A5F0365DB0C91C60DFB9C3852767BFEB7
                                                D9668C844532358CFD58A8BCCE25CE81FD5A82AD9B908EB1503CD2BE6B70B4029B4E262B4E8EB258129274AEE6132A5F0365DB0C91C60DFB9C3852767BFEB7
IV =01068881190205077A5B004085000000
encrypted_bytes =D9668C844532358CFD58A8BCCE25CE81FD5A82AD9B908EB1503CD2BE6B70B4029B4E262B4E8EB258129274AEE6132A5F0365DB0C91C60DFB9C3852767BFEB7
ivv =01068881190205077A5B004085000000
key =00000000000000000000000000000000
(ELL) block 0 block_size 16 offset 0
ivv =01068882190205077A5B004085000000
key =00000000000000000000000000000000
(ELL) block 1 block_size 16 offset 16
ivv =01068883190205077A5B004085000000
key =00000000000000000000000000000000
(ELL) block 2 block_size 16 offset 32
ivv =01068884190205077A5B004085000000
key =00000000000000000000000000000000
(ELL) block 3 block_size 15 offset 48
decrypted_bytes =E0BC74AA3B5F4BD6843F9C305CC6E5B630DA1F9233117B4EB52A9C55F273AC744D0FD84BA2126B856817425FB3F4C88C46963BD440E8288B7551C1EDC45DAD


#### test 2 IV niepoprawny


frame =
4E 44 01 06 89 83 72 02 05 07 7A F2 00 40 85 62 88DF6A0F38633D06CA2B933F70D46CE0B941567C40E3B31822002EA177AC46F165C7C733589088B9D7C8E40431278B7097DF5338A088FC1B840C4714663CDC
												88DF6A0F38633D06CA2B933F70D46CE0B941567C40E3B31822002EA177AC46F165C7C733589088B9D7C8E40431278B7097DF5338A088FC1B840C4714663CDC
												
IV =01068983720205077AF20040850000
encrypted_bytes =88DF6A0F38633D06CA2B933F70D46CE0B941567C40E3B31822002EA177AC46F165C7C733589088B9D7C8E40431278B7097DF5338A088FC1B840C4714663CDC
ivv =01068983720205077AF2004085000000
key =00000000000000000000000000000000
(ELL) block 0 block_size 16 offset 0
ivv =01068984720205077AF2004085000000
key =00000000000000000000000000000000
(ELL) block 1 block_size 16 offset 16
ivv =01068985720205077AF2004085000000
key =00000000000000000000000000000000
(ELL) block 2 block_size 16 offset 32
ivv =01068986720205077AF2004085000000
key =00000000000000000000000000000000
(ELL) block 3 block_size 15 offset 48
decrypted_bytes =B1059221460E435CB34CA7B3E23747D774C1CB43E86246E7C716604AEEAF5E87B3863953B40C5164AD4DD2F564C069A3D22CB3E071A6D96B6D65D48FD99FC6


SN: 2728389 (APA GEN: 5 WATER)
Raw packet (79 bytes):
4E 44 01 06 89 83 72 02 05 07 7A F2 00 40 85 62 88 DF 6A 0F 38 63 3D 06 CA 2B 93 3F 70 D4 6C E0 B9 41 56 7C 40 E3 B3 18 22 00 2E A1 77 AC 46 F1 65 C7 C7 33 58 90 88 B9 D7 C8 E4 04 31 27 8B 70 97 DF 53 38 A0 88 FC 1B 84 0C 47 14 66 3C DC
Header:
4Eh (L-Field)
44h (C-Field: Message type SND_NR (Send spontaneous/periodical application data without request (Send /No Reply))
0106 h (Manufacturer-ID: APA DIN Address is presented with 3 ASCII-letters (A-Z, upper case only). See www.dlms.com/flag)
89837202 -> 2728389 (Identification Number of the WATER device (as 8 BCD numbers))
05 h (Generation: 5, forms together with Manufacturer-ID, IdentNumber and Type a unique wM-Bus address)
07h (Medium: WATER)
7Ah (CI-Field: Short 4 bytes APL header in RSP_UD response from device. Declares the applied type of Transport Layer header)
F2 h (ACC: 242 Access number incremented every synchronous packet which is not repeated)
00h (STS: 0 M-Bus state contents errors and alerts)
4085h (ConfWord: EncryptionMode: 5, CounOfBlocks: 64, Synchronous: False)
Synchronous: False)
IV (Initialization Vector): 0106 89837202 05 07 F2 F2 F2 F2 F2 F2 F2 F2
							0106 89837202 05 07 7A F2
AES 128 Key: 00000000000000000000000000000000
Data (64 bytes):
2F 2F 0F D9 A1 99 96 38 00 08 43 47 03 83 00 1E 95 D9 A1 D9 0F 72 FC 2C 10 60 48 02 00 72 01 60 48 02 00 D7 2A 02 00 7E 1F 02 00 A0
32 2D 05 04 FF FF FF FF FF FF FF FF FF FF FF FF FF FF F2 6B
Meter values:
DIF:0Fh (SpecialFunctions) Data: D9A1999638000843470383001E95D9A1D90F72FC2C1060480200720160480200D72A02007E1F0200A0322D0504FFFFFFFFFFFFFFFFFFFFFFFFFFF
Manufacture specific data D9A1999638000843470383001E95D9A1D90F72FC2C1060480200720160480200D72A02007E1F0200A0322D0504FFFFFFFFFFFFFFFFFFFFFFFFFFFFF2